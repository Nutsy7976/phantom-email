<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Compose Anonymous Email - Phantom</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Component-specific styles for mailer_page.html */
        .container { width: 90%; max-width: 1100px; margin-left: auto; margin-right: auto; }
        .banner { background-color: #d32f2f; color: white; text-align: center; padding: 0.8rem 1rem; font-size: 1rem; font-weight: bold; }
        header { background-color: var(--header-footer-bg); text-align: center; padding: 1.5rem 1rem; font-size: 1.8rem; font-weight: bold; color: var(--accent-teal); border-bottom: 1px solid var(--field-border); }
        header img { height: 40px; vertical-align: middle; margin-right: 12px; } /* Simplified img style */
        .main-section { display: flex; flex-direction: row; justify-content: space-between; padding: 2rem 1rem; gap: 2rem; flex-wrap: wrap; flex-grow: 1; width: 90%; max-width: 1100px; margin: 2rem auto; }
        .left-box, .form-box { flex: 1; min-width: 300px; background-color: var(--panel-bg); padding: 1.5rem 2rem; border-radius: 10px; box-shadow: 0 4px 15px rgba(0, 255, 255, 0.1); box-sizing: border-box; }
        .left-box h2 { margin-top: 0; color: var(--accent-teal); font-size: 1.5rem; border-bottom: 1px solid var(--field-border); padding-bottom: 0.5rem; margin-bottom: 1.25rem; }
        .left-box ul { list-style: none; padding-left: 0; line-height: 1.8; }
        .left-box li { margin-bottom: 0.75rem; }
        .left-box li::before { content: "âœ“ "; color: var(--accent-green); font-weight: bold; margin-right: 8px; }
        .form-box form { display: flex; flex-direction: column; }
        .form-heading { font-family: 'Inter', system-ui, sans-serif; font-size: 1.9rem; color: var(--accent-teal); text-align: center; margin-bottom: 1.25rem; margin-top: -0.5rem; text-shadow: 0 0 6px #00ffff88; font-weight: 600; }
        .form-box label.field-label { display: block; margin-bottom: 5px; font-size: 0.9em; color: var(--muted-text); } /* Label for inputs */
        .form-box input[type="text"],
        .form-box input[type="email"],
        .form-box textarea,
        .form-box input[type="file"] { width: 100%; padding: 12px 15px; margin-bottom: 1.25rem; border: 1px solid var(--field-border); border-radius: 6px; background-color: var(--field-bg); color: var(--field-text); box-sizing: border-box; font-size: 1rem; transition: border-color 0.2s ease, box-shadow 0.2s ease; }
        .form-box input:focus,
        .form-box textarea:focus { outline: none; border-color: var(--accent-teal); box-shadow: 0 0 8px var(--focus-ring-color); }
        .form-box textarea { resize: vertical; }
        .form-box input[type="file"] { padding: 8px; background-color: #444; cursor: pointer; }
        .form-box input[type="file"]::file-selector-button { background-color: #555; color: #fff; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; margin-right: 10px; }
        .form-box button[type="submit"] { box-shadow: 0 0 10px rgba(0, 204, 153, 0.4); width: 100%; background-color: var(--accent-green); color: var(--bg-main); padding: 14px; font-weight: bold; font-size: 1.1rem; border: none; border-radius: 6px; cursor: pointer; transition: background-color 0.2s ease, transform 0.1s ease; margin-top: 0.5rem; }
        .form-box button[type="submit"]:hover { background-color: var(--hover-green); transform: translateY(-2px); }
        .form-box button[type="submit"]:active { transform: translateY(0px); }

        /* Flash Messages Styling */
        .flash-messages { list-style: none; padding: 0; margin: 0 0 1rem 0; }
        .flash-messages li { padding: 0.8rem 1.2rem; margin-bottom: 0.5rem; border-radius: 6px; font-weight: 500; }
        .flash-messages .error { background-color: rgba(255, 0, 0, 0.2); border: 1px solid var(--highlight-red); color: var(--highlight-red); }
        .flash-messages .success { background-color: rgba(0, 204, 153, 0.2); border: 1px solid var(--accent-green); color: var(--accent-green); }

        /* Responsive */
        @media (max-width: 850px) {
          .main-section { flex-direction: column; width: 95%; margin-top: 1rem; margin-bottom: 1.25rem; padding: 1rem 0.5rem; }
          .left-box, .form-box { flex: 1 1 100%; min-width: unset; }
          header { font-size: 1.5rem; }
          header img { height: 30px; }
        }
         @media (max-width: 480px) {
            body { font-size: 15px; }
            header { font-size: 1.3rem; padding: 1rem; }
            header img { height: 25px; margin-right: 8px; }
            .left-box, .form-box { padding: 1rem 1.2rem; }
            .form-box button[type="submit"] { font-size: 1rem; padding: 12px; }
         }
         /* Animation */
        .fade-in { opacity: 0; transform: translateY(20px); animation: fadeInUp 0.8s ease-out forwards; }
        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }
        /* CAPTCHA Placeholder */
        .captcha-placeholder { background-color: var(--field-bg); border: 1px dashed var(--field-border); color: var(--muted-text); text-align: center; padding: 2rem 1rem; margin-bottom: 1.25rem; border-radius: 6px; font-style: italic; }
    </style>
     <!-- TODO: Add CAPTCHA script includes (e.g., hCaptcha) here -->
     <!-- <script src="https://js.hcaptcha.com/1/api.js" async defer></script> -->
</head>
<body>
    <header>
        <img src="{{ url_for('static', filename='images/phantom_logo.png') }}" alt="Phantom Mask Logo">
        Anonymous Email by Phantom
    </header>

    <section class="main-section container">
        <div class="left-box fade-in">
            <h2>Phantom Features</h2>
            <ul>
                <li>No accounts or signups required</li>
                <li>Minimal logging policy for privacy</li>
                <li>Temporary data handling</li>
                <li>Customizable Reply-To address</li> <!-- Adjusted wording -->
                <li>Encrypted connection (TLS)</li> <!-- Adjusted wording -->
                <li>Designed for enhanced anonymity</li>
            </ul>
        </div>

        <div class="form-box fade-in">
            <h1 class="form-heading">Compose Anonymous Email</h1>

             <!-- Flash Messages Area -->
            {% with messages = get_flashed_messages(with_categories=true) %}
              {% if messages %}
                <ul class="flash-messages">
                {% for category, message in messages %}
                  <li class="{{ category }}">{{ message }}</li>
                {% endfor %}
                </ul>
              {% endif %}
            {% endwith %}
            <!-- End Flash Messages -->

            <!-- NOTE: Removed "Free Trial" Checkbox -->
            <form action="{{ url_for('start_payment') }}" enctype="multipart/form-data" method="post">

                <label for="from_name" class="field-label">Sender Name (Fictitious):</label>
                <input name="from_name" id="from_name" placeholder="e.g., Concerned Citizen" required type="text"/>

                <label for="from_email" class="field-label">Sender Email (Sets Reply-To):</label>
                <input name="from_email" id="from_email" placeholder="e.g., info@secure.com (Recipient replies here)" required type="email"/>
                <small style="color: var(--muted-text); font-size: 0.8em; margin-top: -1rem; margin-bottom: 1rem; display: block;">This email address will be set as the 'Reply-To'. It does not change the actual sending address.</small>

                <label for="to_email" class="field-label">Recipient's Email:</label>
                <input name="to_email" id="to_email" placeholder="Recipient's actual email address" required type="email"/>

                <label for="subject" class="field-label">Subject:</label>
                <input name="subject" id="subject" placeholder="Email Subject" required type="text"/>

                <label for="message" class="field-label">Message:</label>
                <textarea name="message" id="message" placeholder="Your anonymous message..." required rows="6"></textarea>

                <label for="file1" class="field-label">Optional Attachment 1:</label>
                <input name="file1" id="file1" type="file"/>

                <label for="file2" class="field-label" style="margin-top: 10px;">Optional Attachment 2:</label>
                <input name="file2" id="file2" type="file"/>

                <!-- TODO: Add CAPTCHA Widget Here -->
                <div class="captcha-placeholder">
                   CAPTCHA Widget Placeholder<br>
                   <!-- Example: <div class="h-captcha" data-sitekey="YOUR_HCAPTCHA_SITE_KEY"></div> -->
                </div>

                <!-- Submit Button -->
                <button type="submit">
                    <span>Pay $3.00 USD & Send</span> <!-- Simplified Text -->
                </button>
            </form>
        </div>
    </section>

    {% include 'footer.html' %}

</body>
</html>